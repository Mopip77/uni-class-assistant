<view><van-notify class="on-top" vue-id="7797b94c-1" id="van-notify" bind:__l="__l"></van-notify><view class="main-title">分数结算<view class="my-button-group"><van-button vue-id="7797b94c-2" custom-class="my-button six-word" square type="warning" data-event-opts="{{[['^tap',[['updateScoreConstitution']]]]}}" bind:tap="__e" bind:__l="__l" vue-slots="{{['default']}}">更改分数构成</van-button><van-button vue-id="7797b94c-3" disabled="{{null===scoreRule||scoreRule.calculating!==0}}" custom-class="my-button" square type="danger" data-event-opts="{{[['^tap',[['calScore']]]]}}" bind:tap="__e" bind:__l="__l" vue-slots="{{['default']}}">结算</van-button></view></view><block wx:if="{{null===scoreRule&&!showUpdateScoreForm}}"><view class="warn-box">还没有设置分数构成</view></block><block wx:if="{{null!==scoreRule&&!showUpdateScoreForm}}"><view class="score-info"><view class="title">分数构成方式(总和为100%)</view><view class="score-info-item sign-in"><text>{{"签到占比: "+scoreRule.signInProp+"%"}}</text><block wx:if="{{scoreRule.signInType===1}}"><text class="tip">{{"每次未签到扣"+scoreRule.scoreEachSignIn+"分"}}</text></block><block wx:else><block wx:if="{{scoreRule.signInType===2}}"><text class="tip">{{"允许"+scoreRule.nTimesFullScore+"次未签到,额外部分每次扣"+scoreRule.scoreEachSignIn+"分"}}</text></block><block wx:else><block wx:if="{{scoreRule.signInType===3}}"><text class="tip">{{"如果超过"+scoreRule.nTimesNoScore+"次未签到则最终分数为0"}}</text></block></block></block></view><view class="score-info-item contest">{{'测试占比: '+scoreRule.contestProp+'%'}}</view><view class="score-info-item course-ware">{{'课件预习占比: '+scoreRule.courseWareProp+'%'}}</view></view></block><block wx:if="{{showUpdateScoreForm}}"><view class="update-score-constitution-box"><view class="title">分数构成方式(总和为100分)</view><view class="item sign-in"><view class="label">签到</view><view class="input-box"><radio-group data-event-opts="{{[['change',[['changeSignInType',['$event']]]]]}}" bindchange="__e"><label class="radio"><radio value="1" checked="{{checked[0]}}"></radio>{{"每次未签到扣"+(needX&&xScore>0?xScore:'x')+"分"}}</label><label class="radio"><radio value="2" checked="{{checked[1]}}"></radio>{{"允许"+(needN&&nScore>0?nScore:'n')+"次未签到，超出部分每次扣"+(needX&&xScore>0?xScore:'x')+"分"}}</label><label class="radio"><radio value="3" checked="{{checked[2]}}"></radio>{{"超过"+(needN&&nScore>0?nScore:'n')+"次签到该课程0分"}}</label></radio-group><view class="score-slider"><slider value="{{signInFullScore}}" max="100" show-value data-event-opts="{{[['change',[['sliderChange',['$event',0]]]]]}}" bindchange="__e"></slider><text>分</text></view><view class="detail-score"><view class="{{[needX?'':'not-need']}}">x:<input type="text" disabled="{{!needX}}" data-event-opts="{{[['input',[['__set_model',['','xScore','$event',[]]]]]]}}" value="{{xScore}}" bindinput="__e"/></view><view class="{{[needN?'':'not-need']}}">n:<input type="text" disabled="{{!needN}}" data-event-opts="{{[['input',[['__set_model',['','nScore','$event',[]]]]]]}}" value="{{nScore}}" bindinput="__e"/></view></view></view></view><view class="item contest"><view class="label">测试</view><view class="input-box"><view class="score-slider"><slider value="{{contestFullScore}}" max="{{maxFullScore}}" show-value data-event-opts="{{[['change',[['sliderChange',['$event',1]]]]]}}" bindchange="__e"></slider><text>分</text></view></view></view><view class="item course-ware"><view class="label">课件预习</view><view class="input-box"><text>{{courseWareFullScore+" 分"}}</text></view></view><view class="my-button-group"><van-button vue-id="7797b94c-4" custom-class="my-button" plain square type="primary" data-event-opts="{{[['^tap',[['cancelUpdateScoreForm']]]]}}" bind:tap="__e" bind:__l="__l" vue-slots="{{['default']}}">取消</van-button><van-button vue-id="7797b94c-5" custom-class="my-button" square type="primary" data-event-opts="{{[['^tap',[['updateScoreForm']]]]}}" bind:tap="__e" bind:__l="__l" vue-slots="{{['default']}}">更改</van-button></view></view></block><block wx:if="{{!showUpdateScoreForm}}"><view><block wx:if="{{scoreRule.calculating===0}}"><view class="warn-box">已经设置了设置了分数构成，可以结算了</view></block><block wx:else><block wx:if="{{scoreRule.calculating===1}}"><view class="warn-box">正在后台计算中，请稍后再来...</view></block><block wx:else><block wx:if="{{scoreRule.calculating===2}}"><view class="score-box"><view class="title">成绩列表</view><view class="score-list"><block wx:for="{{studentScores}}" wx:for-item="studentScore" wx:for-index="idx" wx:key="idx"><view class="score-item"><view class="user-box"><image src="{{studentScore.creator.avatarUrl}}"></image><view class="student-name">{{studentScore.creator.nickname}}</view></view><view class="{{['score',studentScore.score<60?'red':'']}}">{{studentScore.score}}</view></view></block></view></view></block></block></block></view></block></view>